<!DOCTYPE html>
<html>
<body>

<h2>Auto Dungon Master</h2>
<p>Select a session type, challenge rating, and environment from the options below:</p>

<form id="sessionRequest">
  <select name="name" id="name">
    <option value="Monster">Monster</option>
    <option value="NPC">NPC</option>
    <option value="Encounter">Encounter</option>
    <option value="PlotArc">Plot Arc</option>
  </select>
  <select name="cr" id="cr">
    <option value=""></option>
    <option value="0">0</option>
    <option value="1%2F8">1/8</option>
    <option value="1%2F4">1/4</option>
    <option value="1%2F2">1/2</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
  </select>
  <select name="env" id="env">
    <option value=""></option>
    <option value="arctic">Arctic</option>
    <option value="coastal">Coastal</option>
    <option value="desert">Desert</option>
    <option value="forest">Forest</option>
    <option value="grassland">Grassland</option>
    <option value="hill">Hill</option>
    <option value="mountain">Mountain</option>
    <option value="swamp">Swamp</option>
    <option value="underdark">Underdark</option>
    <option value="underwater">Underwater</option>
    <option value="urban">Urban</option>
  </select>
  <br><br>
  <input type="button" value="Submit" onclick="JavaScript:getSessionReply()">
</form>

<p></p>

<input type="text" value="" id="outputText">
  
<script>
function getSessionReply() {
  // Get variables
  let name = document.getElementById('name').value;
  const cr = document.getElementById('cr').value;
  const env = document.getElementById('env').value;
  
  // Build name
  name = name + "By";
  if (cr !== "") {
    if (env !== "") {
      name = name + "CRandEnv";
    } else {
      name = name + "CR";
    }
  } else if (env !== "") {
    name = name + "Env";
  } else {
    name = name + "Itself";
  }
  
  // Build query string
  let url = "https://gf4ajxpfkd.execute-api.us-west-2.amazonaws.com/webAutoDM/autodm?"
  const queryString = "web=1&name=" + name + "&cr=" + cr + "&env=" + env;
  url += queryString;
  
  // Get request
  const Http = new XMLHttpRequest();
  Http.open("GET", url);
  Http.send();
  Http.onreadystatechange=(e)=>{
    // Get response
    const response = JSON.parse(Http.responseText);
    const text = document.getElementById('outputText').value

    // Update output
    document.getElementById('outputText').value = response.body + "\n\n" + text;
  }
}
</script>

</body>
</html>
